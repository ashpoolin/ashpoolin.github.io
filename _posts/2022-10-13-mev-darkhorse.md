---
layout: post
---

## MEV Dark Horse: Rise of the Searcher/Validator

### Idea in Brief
In the spirit of FlashBots, making MEV accessible to all users of Solana is noble goal. I pose, however, that alternative, MEV-enabled clients can alter the incentive structure of the network upon which it lives. Solana has recently made two network improvements: 1. the addition of [QUIC](https://en.wikipedia.org/wiki/QUIC) transport layer protocol, and 2. created an optional field for supplying a priority fee to a transaction. While both positive, these changes affect the dynamics, and cryptoeconomic policy of the blockchain. Solana currently has ~no _base fee_, effectively operating as all _tip_. The fee structure, then, resembles an _[all-pay auction](https://en.wikipedia.org/wiki/All-pay_auction)_. Currently, 50% of the _tip_ (priority fee) is awarded to the miners, and the other 50% is burned. However, [Jito Labs](https://www.jito.wtf/) has proposed offering 100% of the tip to the validators, which I suggest is a risk towards centralization. In the absence of an [EIP-1559](https://ethereum.org/en/developers/docs/gas/#eip-1559)-inspired _base fee_, I pose that there is a significant risk of MEV-sharing _off-chain agreements (OCA)_, and raise the specter of a new class of validator--the _searcher-slash validator (S/V)_--that will enable organized groups to capture more MEV, retain their profits to increase stake, increase the number of slots they control, and ultimately compound their control over the network, at the expense of censorship resistance, and decentralization. 

### Introduction
Solana is changing and growing everyday. We joined the network to enjoy its speed and low fees, and through each new wave of users, we experienced congestion or degraded performance, but were regularly rewarded with impressive upgrades. The most significant improvements--the combination of [QUIC](https://en.wikipedia.org/wiki/QUIC) transport layer protocol and fee markets--are pretty much here, which offer great promise to create a more dynamic blockchain, that can support significantly more users and volume. I absolutely welcome these changes. QUIC brings the assurance that DDoS-scale transaction spamming will not cripple the network. And fee markets ensure that the users whose transactions are most time-sensitive, don't get crowded out of the TPU, and find space in the block, pending they are willing to pay for it. 

With these sweeping upgrades, though, _**the rules of the game are changing**_. Priority fees and the establishment of a fee market is good for congestion management, and also supports the financial sustainability of the network. However, priority fees also change the incentive structure of both users and operators of the chain. And that's what I want to discuss, if for no other reason than to convince myself we are on the right path. 

Without full context, this next part won't make a lot of sense, but I'll state my concern now. Solana's fee market is new, and yet to be stress-tested. I expect we will repeat many mistakes already experienced on Ethereum (e.g. boundless gas prices under peak congestion). With the lack of a mempool, third-party mempools emerge through new clients, to enable new features, and a new means of MEV extraction. As the new layer(s) increase in market share, the rules and idiosyncracies of this alternative client are foisted onto the entire chain. If the specific rules of the client are not aligned with what's good for the network on the whole, it undermines it. I will re-state the problem explicitly here: I believe that as the fee structure is currently designed, we may be enabling a new vector of centralization, by allowing the largest validators to capture more MEV, and thereby accumulate more stake. Greater stake in turn gives the validator more slots per epoch, and finally allows them to capture more MEV. Specifically, the combination of searcher plus validator as one entity (a "vertically-integrated" validator or S/V) will accelerate this concentration of stake, and slots. It's a flywheel.

#### It's Probably Happening Now
I might offer one caveat, that the most sophisticated searchers probably already operate their own validators and RPCs, today. Groups like Jump that have emphasized being "crypto-native" or builders at heart, already identified the opportunity to be the best, by also being the most familiar with low-level operations on the chain. Currently, they are probably already able to capture an outsized amount of MEV, relative to independent searchers. But there is one advantage, currently: the existing Solana Labs client (running fee markets and QUIC) burns half of the priority fee. So, while they can blast multiple transactions to their hearts' delight, they will lose half of any priority fee they pay, and with QUIC, at some point will be told to back off if they send too many. While at an advantage, they still will have to compete in the fee markets with the rest of us.

#### Democratizing MEV
Solana doesn't have a mempool. This is by virtue of its Turbine block propagation scheme, and the fact that the runtime can execute transactions in parallel. When the network is not saturated with transactions, and contingent upon no state contentions (account write locks), then transactions are processed as fast as they come in, and they don't pile up anywhere. This is good for reducing MEV, since juicy transactions don't sit out in public waiting for bots to frontrun them. That's not to say that MEV doesn't exist on Solana, it's just different. And, presuming we ascribe the theory that "MEV is natural and inevitable," then it's in the network's best interest to "democratize" it, or make obtaining it equally accessible to all interested parties. In the spirit of what [FlashBots](https://www.flashbots.net/) accomplished on Ethereum, there's a similar player on Solana--[Jito Labs](https://www.jito.wtf/)--aiming to do just that. 

#### Jito Labs
What Jito is doing by creating their own MEV-enabled client is commendable, and net-net great for the network. I think very highly of both [@buffalu](https://twitter.com/buffalu__) and [@segfaultdoctor](https://twitter.com/segfaultdoctor); they're exceptionally nice [and patient] guys. Their client will bring features that are desperately needed, such as the ability for atomic execution of transaction bundles. This is all-the-more important now, as certain compound defi transactions, or the use of trade aggregators are already at transaction size limits. And, of course, atomic execution can help users prevent the partial failure of compound and/or order-sensitive trades, or getting caught off-guard by some dark forest animal. Finally, allowing validators to participate in the MEV game without having to open a searching outfit allows them to do what they do best, supports their financial viability, and benefits their stakers. I want to be clear: I love what Jito is doing, and am excited by the features and benefits that they will bring to Solana. If you want to understand more about what they are doing, [this recent conversation with Buffalu](https://www.youtube.com/watch?v=WUBLLFTACVM) gives the best explanation I've seen for what Jito's products looks like, and how they behave. So I want to be clear here: I have absolutely _**no beef**_ with Jito or its team, merely, I want to a) discuss a single design decision that has significant implications for the Solana network, and b) to propose a simple change that I think may help address it. 

#### The Slot Machine
I don't really know what it looks like on other chains, but on Solana, a validator earns the right to create blocks based on the amount of coins that are staked. More stake = more slots. With the task of block creation, there is the potential for the validator to extract MEV by inserting, ordering, or censoring transactions in a particular way. Each slot, then, confers the privilege to extract MEV to the validator. If they don't do it themselves, they are still in a position of power, with the opportunity to extract bribes for prioritizing the transactions of searchers that do. It is natural then, in a world with abundant MEV, to aspire to be the validator with the most slot opportunities. The race to control the network isn't really about accumulating more stake, it's about _**acquiring more slots**_.

#### No Mempool
In its current incarnation, since Solana doesn't have a mempool, I don't think validator-based transaction ordering is a big thing--the transactions are just processed as quickly as possible, since that's the behavior of the Solana Labs client. With the new "additional fee," transactions are given priority based on their fee rate (measured in micro-lamports per compute unit), and soon QoS determined by QUIC as a secondary metric for ordering. But with a new client that supports some incarnation of a mempool, the validator can draw from the pool of transactions and order them as they see fit. Presumably giving priority to the transaction that pays the most, but could be whatever as determined by the client's designers.

#### All Tip, No Base
Solana's current fee structure is:
```
total fee = default fee + additional_fee
total fee = default fee + additional_fee_rate * # compute units
total fee (SOL) = 0.000005 SOL + ( additional_fee_rate uL/cu / 10^15 uL/SOL ) * # compute units
```
_Note: the Ethereum analog here would be the `base fee` + `tip`, where I've subtituted `default fee` and `additional fee` for Solana._

On Solana, I believe the `total fee` just goes to the validator to take a commission and distribute the remainder to the stakers. The `additional_fee_rate` is optional, so if it's not included / defaults to zero, you just pay 0.000005 SOL per transaction. However, of the amount that is `additional_fee` (I also call this `priority fee`), 50% is currently burned, and 50% goes to the validator/stakers. This is a nice feature that benefits non-stakers, supports financial sustainability of the chain by reducing supply inflation (slightly).

New fee structure:
As I mentioned above, the creation of a new client introduces the possibility of changing the rules. In the case of Jito, they have elected to reward [100% of the priority fee to the validators](https://discord.com/channels/938287290806042626/938287767446753400/1019716974894383134). This is nice for both stakers and validators, and it will likely compel validators to adopt the client to increase staking revenue. But it has a negative effect, too: if the fee payer is also the validator (e.g. controlled by the same entity), the payer obtains the superpower of bumping every transaction waiting in line, at zero cost. Without the 50% fee burn, all of the `additional_fee` is able to be recovered by payer. 

#### First-Pay Auction
Solana's current fee scheme currently resembles the old Ethereum gas structure, prior to EIP-1559. This is because the default fee of 0.000005 SOL is for all intents and purposes, $0. Solana has a flat, negligible fee, so it is not correct to call this a "base fee." Under congestion, competitive markets or accounts will be operating in a 100% tip (priority fee) regime, which defaults to a _first-pay auction_. Such an auction is known to create difficulty for bidders, often causing them to overpay as they lack the knowledge to correctly calculate the price of gas (or compute units, in Solana's case). This is known to cause intense spikes in the price of block space, and generally worse user experience. To the point: Solana would do well to emulate Ethereum's EIP-1559 and implement a variable, per-account base fee that flexs up/down based on demand and, more importantly, is burned.

#### The Dark Horse
Here I formalize the idea of the _**searcher/validator (S/V)**_. This is an entity that, through its operations has vertically-integrated by acquiring capabilities in all of these dimensions:
- is a **validator** 
- has **infrastructure** for timely, competitve data acquisition (via its own competitively located RPCs and/or validators with Geyser plug-ins). This capability complements the searching activity, making them more effective.
- is a **searcher**. They may be doing the classical MEV (frontrunning, backrunning, arbitrage), or may just be a crypto prop shop with strategies that benefit by being first, or having information first (e.g. market makers, stat arb).

What's hazardous about this? Well, with the creation of a priority fee, the S/V can pay to jump to the front of the line. Normally, it shouldn't be a problem, but, when the searcher and the validator share the same P&L, there's synergistic effects. The searcher can overpay for priority on any slot where its partner validator is the leader. The money just goes from left pocket to right, but with all independent traders and searchers being outbid, and crowded out of the action. In an effort to win trades, they may chronically overpay, thereby hurting their financial viability, causing them fail and close up shop. 

#### MEV Flywheel
Users and validators put up stake to get more slots, they've got skin in the game, so what's the problem? The issue I pose is that with the priority fee, this is an _accelerant_ to concentrating stake at top validators. The dominant validators with the most stake also have the most slots, and greatest opportunities to capture MEV. Well, you say, if all validators are able to run an MEV-enabled client, then they will all have equal opportunity to capture MEV, commensurate to the amount of stake they have. The problem stems from the searcher/validator above, since it perverts competition for MEV. _**They are able to participate in the most lucrative activity on-chain (MEV extraction), at essentially zero cost**_. The low, default 0.000005 SOL transaction fee is such that it is hard to turn a profit as a validator, and nearly impossibile to differentiate since all validators offer very similar yields. MEV will likely transform what validator revenues look like, and I expect it to become the primary revenue source for all validators. But the S/V doesn't have to pay out as much to their stakers, since they will be winning more of the time. And if they're big enough, they could even opt to set their commission to 100%, lock out others, and keep all proceeds for themselves. With the large number of slots they have, the more MEV they capture, they can retain it in their stake, to increase the number of slots that they get. Considering how compounding works, the greater retained MEV at the validator, the faster they grow, relative to their peers. This all sounds pretty circular, so let me be clear: _**the problem is not that by virtue of being large that they win. it is because of the relationship between searcher + validator, that they will consistently win the MEV (by outbidding independent searchers), and are able to retain it in their stake.**_ This enhanced stake retention is what will make the S/V more formidable, and ultimately, more centralizing.

#### Game Theory
Let's consider the current state of an arbitrageur (searcher) on Solana today. According to the [Jito MEV dashboard](https://jito.retool.com/embedded/public/7e37389a-c991-4fb3-a3cd-b387859c7da1), almost 97% of arbs fail. If we consider this the "competitive" state, the logical seacher should only pay about 3% of their average expected MEV profit for priority fees, to break even. Let's evaluate this on a recurring, theoretical arb opportunity of exactly 1 SOL:
```
expected value = p_win * profit + p_lose * loss
expected value = p_win * (reward - priority_fee) + p_lose * priority_fee

substituting the values, for the break-even condition:
0 = (0.03 * (1 SOL - priority_fee) + (0.97 * priority_fee)
0 = 0.03 SOL - priority_fee
priority_fee = 0.03 SOL
```
For the rational searcher, there's an upper limit on the total fee / priority fee they can spend. Under the current fee regime (50% burn/50% tip), a vertically-integrated S/V can already get away with paying more on any slot they are the validator, since they will recoup half of the priority fee at the end of the epoch. So, to win versus the rational searcher, they bid 0.030001 priority fee, with their actual cost somewhere around 0.015 SOL, less a discount for the fact they won't recover the funds for 1-3 days. 

At 50% burn of the priority fee, the S/V already has a distinct advantage, but its fee costs are not unbounded. But if their priority fees are 0%, for each of their leader positions the upper limit of the fee they can spend is essentially infinite. This would be the "non-competitive" state. Theoretically, _**they should win all first-pay auctions for MEV when they are the leader**_. Here's a plot of the maximum fee a S/V could pay, versus the percentage of priority fee ("burn coefficient") that is burned: 
![priority fee vs. burn coefficient](/images/priority_fee_vs_burn.png) 
Takeaway: the smaller the burn, the less competitive, while as the burn coefficient approaches 100%, the difference between a rational searcher and the searcher/validator converges to 1 (no advantage to the S/V).

#### MEV with a Relayer
One other wrinkle: using a relay, losing or failing transactions are no longer sent to the leader. For this reason, the failing transaction will not incur any cost (it is no longer an all-pay auction, but a sealed-bid auction). This will allow each searcher to pay a lot more priority fees for each transaction, up to high percentages of the total opportunity. In this way, the expected value for MEV on Jito or another mempool+relayer might look more like this:
```
expected value = p_win * (reward - priority_fee) + p_lose * 0
``` 
Here, a searcher/validator may end up actually paying more fees than the size of the MEV opportunity, since (they expect to recover some of the fees). To understand whether this is happening, I would merely consult the blockchain to see if occurrences of it crop up. In this regime, I don't think the dynamics have changed, just that overall spend for priority fees has increased (since there's no penalty for losing the auction). This has no net effect on the profitability of the S/V, since it is presumed their priority fee expenses are still zero, but in the instance they are outbid, they will now enjoy hefty bribes that can be repatriated to their stake warchest, to further increase their advantage.

#### Counterpoint
In this [great article](https://www.recvc.com/mev-2-0-the-rise-of-mpsvs/), Ali Sheikh shows how he believes that _MEV profit-sharing validators (MPSVs)_ are naturally competitive and will serve as a foil to stake centralization. I would urge you to read it and decide for yourself. While Ali makes a good point that users will move stake to the validators that share the most MEV with their stakers, I do not believe that he has fully explored the case where dominant validators bolt on a searching capability, and retain their MEV earnings to further increase the number of slots they control. We should also consider that MPSVs that distribute a greater portion of their MEV to stakers may have less stake to control slots (some users will remove their profits); they're at a disadvantage to a S/V that can maintain its current stake levels, while also reinvesting the profits that they still control. 

#### Inspiration From Ethereum
FlashBots has by many measures been a success. I can't find the stat but if I recall, some 80% of validators were running MEV-geth. [With MEV-boost, they created neutral infrastructure, support proposer-builder separation (PBS), and prevent "MEV-hiding."](https://members.delphidigital.io/reports/has-flashbots-market-share-plateaued). They helped eliminate a great deal of surge pricing in gas as searchers now had a transparent venue to ensure their transactions went through, without spamming the mempool ([which takes up block space with failed txs](https://mirror.xyz/0xshittrader.eth/WiV8DM3I6abNMVsXf-DqioYb2NglnfjmM-zSsw2ruG8)). But it should be noted that a lot of these benefits came from tailwinds associated with the merge to proof-of-stake, and more importantly, [EIP-1559](https://ethereum.org/en/developers/docs/gas/#eip-1559). What's notable is that EIP-1559 fixed the default first-pay gas auction to a fee structure that is a _base fee_ + _tip_ (priority fee). Here, the base fee is 100% burned. This was deemed necessary, to prevent miners/validators from spamming the network with transactions, and driving up the base fee to increase their own revenues. And, as [Hasu]() so eloquently explains in [this Bankless episode](https://shows.banklesshq.com/p/-eip-1559-hasu), it is also a deterrent to off-chain agreements (and the S/V), since, as the base fee comprises a significant portion of the total fee, an overzealous searcher cannot enjoy the assurance that they will get their gas expense back. EIP-1559 ensures that only the tip is recoverable in such a scenario.

#### Moving Forward
I believe that there are a number of ways to mitigate the issues I've outlined above, which I think could support competition for MEV, and help keep stake decentralized. The first, and obvious solution is for Jito to continue to burn 50% of all priority fees. Again, this is a deterrent to off-chain agreements, and for S/V's who would otherwise evade the costs of block space priority auctions. As shown above, 50% is already not optimal (100% is), but supports competition versus a 0% burn. In the longer run, I see that adding a flexible base fee on a per-account basis, which is entirely burned, would enshrine protection against S/V and OCA. And, finally, a personal favorite idea: [Anatoly suggests that more than one validator could be tasked with building blocks on each slot](https://twitter.com/aeyakovenko/status/1580997876997443584). This would ensure that, although a S/V owns the slot, they cannot guarantee that they will recover the funds they spend on priority fees, since it may go to another validator.


#### Conclusion
Well, this is probably a healthy place to wrap it up. In the article I discussed a primary objection to Solana's current fee structure--in that it behaves essentially like an "all tip" gas price on Ethereum, and that, absent any portion of that fee being burned, will enable searcher-slash-validator (S/V) outfits to side-step priority fees altogether, and subverting MEV competition. I proposed a few immediate options for reducing this risk, primarily, ensuring that some portion of fees are burned under all scenarios, with the ultimate goal of instituting a per-account, EIP-1559-inspired base fee, or a strategy with comparable effect. 

While this article is likely divisive, I want to emphasize I don't have problems with people in the ecosystem. This is constructive criticism about a single design decision, and why I would like it reconsidered. Many of you will not agree with me, and I welcome you to show me the flaws in my reasoning. This would help us all sleep better at night. Where my objections are valid, I'd like to this helps shine light on them, so that we can correct course, thereby preserving the decentralized properties of our beloved network.

Thanks for reading, and if you found this helpful, please consider sharing it.
_-Ash_




